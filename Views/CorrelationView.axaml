<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:HealthOptimizer.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="1120" d:DesignHeight="900"
             x:Class="HealthOptimizer.Views.CorrelationView"
             x:DataType="vm:CorrelationViewModel"
             Background="#F5F7FA">

	<ScrollViewer>
		<StackPanel Margin="40" Spacing="32">

			<!-- Page Header -->
			<StackPanel Spacing="8">
				<TextBlock Text="Carbs vs Blood Pressure"
						   FontSize="36"
						   FontWeight="Bold"
						   Foreground="#1E293B"/>
				<TextBlock Text="Finding your optimal carb sweet spot"
						   FontSize="16"
						   Foreground="#64748B"/>
			</StackPanel>

			<!-- Stats Cards -->
			<Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto">

				<Border Grid.Column="0"
						Background="White"
						Padding="28"
						CornerRadius="16"
						BoxShadow="0 1 3 0 #15000000"
						Margin="0,0,12,0">
					<StackPanel Spacing="12">
						<TextBlock Text="CORRELATION"
								   FontSize="13"
								   FontWeight="SemiBold"
								   Foreground="#64748B"/>
						<TextBlock Text="{Binding CorrelationCoefficient, StringFormat='{}{0:F3}'}"
								   FontSize="40"
								   FontWeight="Bold"
								   Foreground="#3B82F6"/>
						<TextBlock Text="{Binding CorrelationStrength}"
								   FontSize="16"
								   FontWeight="SemiBold"
								   Foreground="#1E293B"/>
					</StackPanel>
				</Border>

				<Border Grid.Column="1"
						Background="White"
						Padding="28"
						CornerRadius="16"
						BoxShadow="0 1 3 0 #15000000"
						Margin="6,0,6,0">
					<StackPanel Spacing="12">
						<TextBlock Text="OPTIMAL RANGE"
								   FontSize="13"
								   FontWeight="SemiBold"
								   Foreground="#64748B"/>
						<StackPanel Orientation="Horizontal"
									Spacing="12"
									HorizontalAlignment="Center">
							<TextBlock Text="{Binding OptimalCarbsMin, StringFormat='{}{0}g'}"
									   FontSize="32"
									   FontWeight="Bold"
									   Foreground="#10B981"/>
							<TextBlock Text="-"
									   FontSize="32"
									   Foreground="#94A3B8"
									   VerticalAlignment="Center"/>
							<TextBlock Text="{Binding OptimalCarbsMax, StringFormat='{}{0}g'}"
									   FontSize="32"
									   FontWeight="Bold"
									   Foreground="#10B981"/>
						</StackPanel>
						<TextBlock Text="carbs per day"
								   FontSize="13"
								   Foreground="#94A3B8"
								   HorizontalAlignment="Center"/>
					</StackPanel>
				</Border>

				<Border Grid.Column="2"
						Background="White"
						Padding="28"
						CornerRadius="16"
						BoxShadow="0 1 3 0 #15000000"
						Margin="12,0,0,0">
					<StackPanel Spacing="12">
						<TextBlock Text="BP IMPROVEMENT"
								   FontSize="13"
								   FontWeight="SemiBold"
								   Foreground="#64748B"/>
						<StackPanel HorizontalAlignment="Center">
							<TextBlock Text="{Binding AvgBPInOptimalRange, StringFormat='{}{0:F1}'}"
									   FontSize="36"
									   FontWeight="Bold"
									   Foreground="#10B981"
									   HorizontalAlignment="Center"/>
							<TextBlock Text="vs"
									   FontSize="13"
									   Foreground="#94A3B8"
									   HorizontalAlignment="Center"
									   Margin="0,4,0,4"/>
							<TextBlock Text="{Binding AvgBPOutsideRange, StringFormat='{}{0:F1}'}"
									   FontSize="24"
									   FontWeight="SemiBold"
									   Foreground="#EF4444"
									   HorizontalAlignment="Center"/>
						</StackPanel>
						<TextBlock Text="mmHg systolic"
								   FontSize="11"
								   Foreground="#94A3B8"
								   HorizontalAlignment="Center"/>
					</StackPanel>
				</Border>

			</Grid>

			<!-- Recommendation Card -->
			<Border Background="White"
					Padding="40"
					CornerRadius="16"
					BoxShadow="0 1 3 0 #15000000">
				<StackPanel Spacing="16">
					<TextBlock Text="Recommendation"
							   FontSize="20"
							   FontWeight="Bold"
							   Foreground="#1E293B"/>
					<TextBlock Text="{Binding Recommendation}"
							   TextWrapping="Wrap"
							   FontSize="15"
							   LineHeight="26"
							   Foreground="#475569"/>
				</StackPanel>
			</Border>

			<!-- Scatter Plot Card -->
			<Border Background="White"
					Padding="32"
					CornerRadius="16"
					BoxShadow="0 1 3 0 #15000000">
				<StackPanel Spacing="20">
					<TextBlock Text="Carbs vs Systolic BP Scatter Plot"
							   FontSize="20"
							   FontWeight="Bold"
							   Foreground="#1E293B"/>
					<Border x:Name="ScatterChartContainer"
							Background="White"
							Height="420"/>
				</StackPanel>
			</Border>

			<!-- Status Message -->
			<TextBlock Text="{Binding StatusMessage}"
					   Foreground="#94A3B8"
					   FontSize="13"
					   HorizontalAlignment="Center"
					   Margin="0,0,0,32"/>

		</StackPanel>
	</ScrollViewer>

</UserControl>